--- openbsd-master/lib/.patch	1970-01-01 01:00:00 +0100
+++ openbsd-master/lib/.patch	2025-09-12 11:34:13 +0200
@@ -0,0 +1 @@
+This directory has been patched.
--- openbsd-master/lib/libcrypto/crypto/arch/i386/Makefile.inc
+++ openbsd-master/lib/libcrypto/crypto/arch/i386/Makefile.inc	Sun Oct 19 10:28:04 2025
@@ -52,7 +52,7 @@
 ${f}.S: ${LCRYPTO_SRC}/${dir}/asm/${f}.pl ${LCRYPTO_SRC}/perlasm/x86gas.pl
 	/usr/bin/perl -I${LCRYPTO_SRC}/perlasm -I${LCRYPTO_SRC}/${dir}/asm \
 		${LCRYPTO_SRC}/${dir}/asm/${f}.pl \
-		    openbsd-elf ${CFLAGS} 386 ${PICFLAG} > ${.TARGET}
+		    openbsd-coff ${CFLAGS} ${PICFLAG} > ${.TARGET}
 .endfor
 
 CFLAGS+= -DOPENSSL_CPUID_OBJ
@@ -61,4 +61,4 @@
 
 x86cpuid.S: ${LCRYPTO_SRC}/x86cpuid.pl ${LCRYPTO_SRC}/perlasm/x86gas.pl
 	/usr/bin/perl -I${LCRYPTO_SRC}/perlasm ${LCRYPTO_SRC}/x86cpuid.pl \
-		openbsd-elf ${CFLAGS} 386 ${PICFLAG} > ${.TARGET}
+		openbsd-coff ${CFLAGS} ${PICFLAG} > ${.TARGET}
--- openbsd-master/lib/libcrypto/crypto/Makefile
+++ openbsd-master/lib/libcrypto/crypto/Makefile	Sun Oct 19 07:49:51 2025
@@ -397,8 +397,7 @@
 	    mkdir ${DESTDIR}/usr/include/openssl
 	@cd ${SSL_SRC}; \
 	for i in $(HDRS); do \
-	    j="cmp -s $$i ${DESTDIR}/usr/include/openssl/`basename $$i` || \
-	    ${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 $$i\
+	    j="${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 $$i\
 		${DESTDIR}/usr/include/openssl"; \
 	    echo $$j; \
 	    eval "$$j"; \
--- openbsd-master/lib/libcurses/Makefile
+++ openbsd-master/lib/libcurses/Makefile	Mon Oct 13 10:50:50 2025
@@ -64,6 +64,7 @@
 HOSTLDFLAGS?=	${LDFLAGS}
 HOSTCFLAGS+=	-I. -I${.CURDIR} ${CURSESTRACE}
 CFLAGS+=	-I. -I${.CURDIR} ${CURSESTRACE}
+LDADD+= -Wl,--image-base=0x0FA00000
 
 MAN=	curs_addch.3 curs_addchstr.3 curs_addstr.3 curs_attr.3 \
 	curs_beep.3 curs_bkgd.3 curs_bkgrnd.3 curs_border.3 curs_border_set.3 \
--- openbsd-master/lib/libedit/Makefile
+++ openbsd-master/lib/libedit/Makefile	Mon Oct 13 10:49:20 2025
@@ -67,6 +67,7 @@
 
 #SUBDIR+=	readline
 HOST_SH=	sh
+LDADD= -lcurses -Wl,--image-base=0x0FC00000
 
 vi.h: vi.c makelist
 	${HOST_SH} ${LIBEDITDIR}/makelist -h ${LIBEDITDIR}/vi.c \
--- openbsd-master/lib/libkvm/Makefile
+++ openbsd-master/lib/libkvm/Makefile	Fri Oct 10 18:10:38 2025
@@ -18,7 +18,7 @@
 .endif
 .endif
 
-CFLAGS+= -D_LIBKVM
+CFLAGS+= -D_LIBKVM -I../../sys
 SRCS+=	kvm.c kvm_file2.c kvm_getloadavg.c kvm_proc.c kvm_proc2.c \
 	kvm_cd9660.c kvm_udf.c kvm_ntfs.c
 
--- openbsd-master/lib/libsqlite3/Makefile
+++ openbsd-master/lib/libsqlite3/Makefile	Thu Oct  9 05:59:43 2025
@@ -44,7 +44,7 @@
 		-DSQLITE_ENABLE_FTS3_PARENTHESIS \
 		-DSQLITE_OMIT_BUILTIN_TEST
 
-CPPFLAGS += 	$(FEATURE_FLAGS) -DSQLITE_THREADSAFE=1 \
+CPPFLAGS += 	$(FEATURE_FLAGS) -DSQLITE_THREADSAFE=0 \
 		-DHAVE_STDINT_H=1 -DHAVE_INTTYPES_H=1 \
 		-DHAVE_GMTIME_R=1 \
 		-DHAVE_LOCALTIME_R=1 \
--- openbsd-master/lib/libssl/src/crypto/perlasm/x86asm.pl
+++ openbsd-master/lib/libssl/src/crypto/perlasm/x86asm.pl	Fri Oct 10 10:22:29 2025
@@ -234,6 +234,8 @@
     {	$coff=1;		require "x86gas.pl";	}
     elsif (($type eq "macosx"))
     {	$aout=1; $macosx=1;	require "x86gas.pl";	}
+    elsif (($type eq "openbsd-coff"))
+    {   $openbsd=$coff=1;       require "x86gas.pl";    }
     elsif (($type eq "openbsd-elf"))
     {	$openbsd=$elf=1;	require "x86gas.pl";	}
     elsif (($type eq "openbsd-a.out"))
--- openbsd-master/lib/libssl/ssl/Makefile
+++ openbsd-master/lib/libssl/ssl/Makefile	Fri Oct 10 10:22:29 2025
@@ -4,6 +4,7 @@
 
 SSL_SRC=	${.CURDIR}/../../libssl/src
 LSSL_SRC=	${SSL_SRC}/ssl
+LDADD+= -lcrypto
 
 .include <bsd.own.mk>
 CFLAGS+= -Wall
--- openbsd-master/lib/libutil/Makefile
+++ openbsd-master/lib/libutil/Makefile	Mon Oct 13 10:23:29 2025
@@ -2,6 +2,7 @@
 #	$NetBSD: Makefile,v 1.8 1996/05/16 07:03:28 thorpej Exp $
 
 LIB=	util
+LDADD+= -Wl,--image-base=0x0FB00000
 
 HDRS=	util.h imsg.h
 SRCS=	bcrypt_pbkdf.c check_expire.c duid.c getmaxpartitions.c \
